import { TrackCard } from '@/components/TrackCard';
import { trackActions, trackSelectors, useAppDispatch, useAppSelector } from '@/state';
import { greeting } from '@/utils';
import { Grid, Title } from '@mantine/core';
import Head from 'next/head';
import { useEffect } from 'react';

import type { NextPage } from "next";
const Home: NextPage = () => {
  const dispatch = useAppDispatch();
  const tracks = useAppSelector(trackSelectors.selectAllTracks);

  useEffect(() => {
    dispatch(trackActions.fetchTracks());
  }, [dispatch]);

  return (
    <>
      <Head>
        <meta name="description" content="Generated by create-t3-app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <div className="">
        <Title order={2}>Hello! {greeting()}!</Title>

        <Title order={2}>Recently Played</Title>

        <Grid className="max-w-full" gutter="sm" mt={10}>
          {tracks.map((track) => {
            return (
              <Grid.Col key={track.id} sm={4} md={3}>
                <TrackCard track={track} />
              </Grid.Col>
            );
          })}
        </Grid>
      </div>
    </>
  );
};

export default Home;
